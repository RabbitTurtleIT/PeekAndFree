<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <title>피크앤프리</title>

  <!-- Google 애드센스 -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6014668630461832" crossorigin="anonymous"></script>
  
  <!-- Firebase Scripts -->
  <script defer src="/__/firebase/11.7.1/firebase-app-compat.js"></script>
  <script defer src="/__/firebase/11.7.1/firebase-auth-compat.js"></script>
  <script defer src="/__/firebase/11.7.1/firebase-database-compat.js"></script>
  <script defer src="/__/firebase/11.7.1/firebase-firestore-compat.js"></script>
  <script defer src="/__/firebase/11.7.1/firebase-functions-compat.js"></script>
  <script defer src="/__/firebase/11.7.1/firebase-messaging-compat.js"></script>
  <script defer src="/__/firebase/11.7.1/firebase-storage-compat.js"></script>
  <script defer src="/__/firebase/11.7.1/firebase-analytics-compat.js"></script>
  <script defer src="/__/firebase/11.7.1/firebase-remote-config-compat.js"></script>
  <script defer src="/__/firebase/11.7.1/firebase-performance-compat.js"></script>
  <script defer src="/__/firebase/init.js?useEmulator=true"></script>
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
  
  <!-- Mapbox CSS -->
  <link href="https://api.mapbox.com/mapbox-gl-js/v3.12.0/mapbox-gl.css" rel="stylesheet">
  
  <!-- Custom CSS -->
  <link href="css/index.css" rel="stylesheet">
  
  <!-- jQuery -->
  <script src="js/jquery-3.7.1.min"></script>
  
  <!-- Mapbox JS -->
  <script src="https://api.mapbox.com/mapbox-gl-js/v3.12.0/mapbox-gl.js"></script>
  
  <!-- Custom JS -->
  <script src="js/index.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/countryalert.js"></script>
  <script src="js/map.js"></script>
</head>

<body>
  <!-- Loading Spinner -->
  <div id="loading" class="position-fixed w-100 h-100 text-center" style="z-index: 10; display: flex;">
    <div style="margin: auto;">
      <div class="spinner-border" role="status"></div>
    </div>
  </div>
  <!-- Header -->
  <header class="top d-flex justify-content-between align-items-center border-bottom px-4 py-3">
    <div class="logo">
      <img src="img/logo.png" style="height: 50px;" alt="피크앤프리 로고">
    </div>
    <div class="search-bar d-flex align-items-center gap-2">
      <input type="text" placeholder="장어 덮밥이 맛있는 일본 나고야" class="form-control rounded-pill border-2" style="width: 260px;">
      <button class="search-btn btn p-1">
        <img src="img/search.png" alt="검색">
      </button>
      <button id="mypage-btn" class="mypage-btn btn p-1" type="button">
        <img src="img/account_circle.png" alt="마이페이지">
      </button>
    </div>
  </header>
  <!-- Main Carousel Section -->
  <!-- <section class="main-section">
    <div class="carousel-wrapper">
      <div id="mainCarousel" class="carousel slide" data-bs-ride="carousel">
        <div class="carousel-inner rounded">
          <div class="carousel-item active px-5">
            <img src="img/epic_x.png" class="d-block w-100" style="object-fit: cover;" alt="메인 이미지 1">
          </div>
          <div class="carousel-item px-5">
            <img src="img/Rectangle 25.png" class="d-block w-100" style="object-fit: cover;" alt="메인 이미지 2">
          </div>
          <div class="carousel-item px-5">
            <img src="img/Rectangle 25.png" class="d-block w-100" style="object-fit: cover;" alt="메인 이미지 3">
          </div>
          <div class="carousel-item px-5">
            <img src="img/Rectangle 25.png" class="d-block w-100" style="object-fit: cover;" alt="메인 이미지 4">
          </div>
          <div class="carousel-item px-5">
            <img src="img/Rectangle 25.png" class="d-block w-100" style="object-fit: cover;" alt="메인 이미지 5">
          </div>
        </div>
        
        <button class="carousel-control-prev" type="button" data-bs-target="#mainCarousel" data-bs-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="visually-hidden">이전</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#mainCarousel" data-bs-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="visually-hidden">다음</span>
        </button>
      </div>
      
      <div class="custom-indicators text-center mt-3">
        <img src="img/btn_unselected.png" class="indicator-dot" data-index="0" alt="인디케이터 1">
        <img src="img/btn_unselected.png" class="indicator-dot" data-index="1" alt="인디케이터 2">
        <img src="img/btn_unselected.png" class="indicator-dot" data-index="2" alt="인디케이터 3">
        <img src="img/btn_unselected.png" class="indicator-dot" data-index="3" alt="인디케이터 4">
        <img src="img/btn_unselected.png" class="indicator-dot" data-index="4" alt="인디케이터 5">
      </div>
    </div>
  </section> -->
  <!-- Travel Planning Section -->
  <!-- <section class="select text-center">
    <h1 class="fw-bold mb-2">여행을 얼마나 계획하셨나요?</h1>
    <p class="additional-text text-muted mb-4">peak and free가 여행 준비를 도와드릴게요!</p>
    <div class="btn-toggle-wrap">
      <button id="btn-when" class="btn-toggle active">언제 떠날지 정했어요!</button>
      <button id="btn-where" class="btn-toggle">어디로 떠날지 정했어요!</button>
    </div>
  </section> -->


  <!-- When Content Section -->
  <section id="when-content" class="select-result" style="display: block;">
  
    <section class="map-section">
      <div class="map-background">
        <div class="whereFetchDone"></div>
        <div class="map-search d-flex justify-content-center align-items-center">
          <input type="text" class="form-control search-input" id="searchbox" placeholder="도시, 나라 또는 공항">
        </div>
        
        <div class="container map-container" id="when-mapdiv">
          <div id="map" style="width: 100%; height: 100vh;">
            <div class="nearby-btn-group" style="position: absolute; z-index: 1;">
              <button class="btn-budget">예산에 가까운 지역</button>
              <button class="btn-nearby">나와 가까운 지역</button>
            </div>
          </div>
        </div>
        
        <div class="container-sm">
          <div id="nearbyFlightList" class="mt-3 pb-3 text-center"></div>
        </div>
      </div>
    </section>
    <section class="calendar-section" id="when-calsec">
      <div class="container calendar-container">
        <div class="month-navigation">
          <button class="nav-btn" onclick="changeMonth(-1)">‹</button>
          <div class="w-100 d-flex justify-content-around">
            <div class="month-title" id="monthTitle1">2025년 7월</div>
            <div class="month-title" id="monthTitle2">2025년 8월</div>
          </div>
          <button class="nav-btn" onclick="changeMonth(1)">›</button>
        </div>
        
        <div class="row">
          <div class="col-md-6">
            <div class="calendar-grid" id="calendar1"></div>
          </div>
          <div class="col-md-6">
            <div class="calendar-grid" id="calendar2"></div>
          </div>
        </div>
      </div>
      <div id="calendar"></div>
    </section>

  </section>
  <!-- Final Reservation Section -->
  <section class="final-reservation">
    <div class="reservation-background"></div>
    <div class="reservation-content mt-5" style="z-index: 1;">
      <h3 class="final-title text-center">피크앤프리와 함께 만든 이번 여행이에요 ⬇️</h3>
      
      <div class="map-background p-3 text-center">
        <div class="container">
          <h4>📅<span id="startDate"></span> ~ <span id="endDate"></span></h4>
          <h4>🌎 <span id="viewLocationName"></span> • 👤<span id="viewCountPeople"></span> • 💺<span id="viewSeatClass"></span></h4>
          <br>
          <div id="skyscannerDiv">

          </div>
        </div>
      </div>
  </section>
  
      <!-- 해외 안전 정보 -->
      <div class="container">
        <div class="content mt-3 mb-3">
          <h4>해외 안전 소식도 알아가세요 ⛑️</h4>
          <div id="countryalert" class="row justify-content-between"></div>
        </div>
      </div>
    </div>


  <div class="modal fade" id="detailModal" tabindex="-1" aria-labelledby="detailModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable modal-xl">
      <div class="modal-content">
        <div class="modal-body ">
          <div class="row">
            <div class="col-lg-6 col-md-12">
              <h3 id="countryName">일본</h3>
              <img id="countryImg" style="max-height: 300px; max-width: 300px;"
                src="https://cdn.huffingtonpost.kr/news/photo/201712/62011_117968.jpeg">
              <p id="countryDesc">전통과 첨단이 어우러진 매혹의 나라, 일본.<br>사계절의 아름다움 속에서 섬세한 문화를 경험해보세요!</p>
              
              <h3>여행자 리뷰</h3>
              <div class="reviewdiv">

              </div>
            </div>
            <div class="col-lg-6 col-md-12 ">
              <h3>정보<a style="float: right;" class="btn btn-light">예매하기</a></h3>
              <div class="preferLocation">

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-9CJ1EX0RKW"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());
    gtag('config', 'G-9CJ1EX0RKW');
  </script>

  <!-- Firebase Initialization -->
  <script>
    document.addEventListener('DOMContentLoaded', function () {

      firebase.functions().httpsCallable('getGoogleMapAPIKey')().then((result) => {
        (g => { var h, a, k, p = "The Google Maps JavaScript API", c = "google", l = "importLibrary", q = "__ib__", m = document, b = window; b = b[c] || (b[c] = {}); var d = b.maps || (b.maps = {}), r = new Set, e = new URLSearchParams, u = () => h || (h = new Promise(async (f, n) => { await (a = m.createElement("script")); e.set("libraries", [...r] + ""); for (k in g) e.set(k.replace(/[A-Z]/g, t => "_" + t[0].toLowerCase()), g[k]); e.set("callback", c + ".maps." + q); a.src = `https://maps.${c}apis.com/maps/api/js?` + e; d[q] = f; a.onerror = () => h = n(Error(p + " could not load.")); a.nonce = m.querySelector("script[nonce]")?.nonce || ""; m.head.append(a) })); d[l] ? console.warn(p + " only loads once. Ignoring:", g) : d[l] = (f, ...n) => r.add(f) && u().then(() => d[l](f, ...n)) })({
          key: result.data,
          v: "weekly",
          // Use the 'v' parameter to indicate the version to use (weekly, beta, alpha, etc.).
          // Add other bootstrap parameters as needed, using camel case.
        });
        console.log("Google map ready")
      }).catch((error) => {
        console.log("ERROR!", error);
      });

      firebase.functions().httpsCallable('getInformationOfCountry')().then((result) => {
        console.log("해외안전정보");
        displaySafetyNotices(result.data.response.body);
      }).catch((error) => {
        console.log("ERROR!", error);
      });



      firebase.analytics();

      try {
        let app = firebase.app();
        let features = [
          'auth',
          'database',
          'firestore',
          'functions',
          'messaging',
          'storage',
          'analytics',
          'remoteConfig',
          'performance',
        ].filter(feature => typeof app[feature] === 'function');
      } catch (e) {
        console.error(e);
      }
    });
  </script>
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
</body>

</html>